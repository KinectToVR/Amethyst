Invoke-WebRequest -Uri 'https://github.com/wixtoolset/wix3/releases/latest/download/wix311-binaries.zip' -OutFile './wix.zip'
Expand-Archive -Path wix.zip -DestinationPath "C:/Program Files (x86)/WiX Toolset v3.11/bin/"

mkdir external/KinectMSI
cd external/KinectMSI

Invoke-WebRequest -Uri 'https://download.microsoft.com/download/F/2/D/F2D1012E-3BC6-49C5-B8B3-5ACFF58AF7B8/KinectSDK-v2.0_1409-Setup.exe' -OutFile './sdk20.exe'
Invoke-WebRequest -Uri 'https://download.microsoft.com/download/E/1/D/E1DEC243-0389-4A23-87BF-F47DE869FC1A/KinectSDK-v1.8-Setup.exe' -OutFile './sdk10.exe'

&"C:/Program Files (x86)/WiX Toolset v3.11/bin/dark.exe" ./sdk20.exe -x KV2
cd ./KV2/AttachedContainer
Get-ChildItem . -Filter *.msi | Foreach-Object { Start-Process msiexec.exe -Wait -ArgumentList "/i $_ /qn /norestart" }

cd ../..
&"C:/Program Files (x86)/WiX Toolset v3.11/bin/dark.exe" ./sdk10.exe -x KV1
cd ./KV1/AttachedContainer
Get-ChildItem . -Filter *x64.msi | Foreach-Object { Start-Process msiexec.exe -Wait -ArgumentList "/i $_ /qn /norestart" }

Import-Module "$env:ProgramData\Chocolatey\helpers\chocolateyProfile.psm1"
Update-SessionEnvironment